{"version":3,"sources":["../../../../assets/scripts/assets/scripts/GameManager.js"],"names":["Sheep","require","Scroller","State","cc","Enum","Menu","Run","Over","GameManager","Class","extends","Component","properties","sheep","gameOverMenu","Node","scoreText","Label","gameBgAudio","default","url","AudioClip","dieAudio","gameOverAudio","scoreAudio","statics","onLoad","D","game","director","getCollisionManager","enabled","state","score","string","active","init","start","pipeManager","startSpawn","startRun","gameOver","audioEngine","stopMusic","playEffect","reset","getComponent","gainScore"],"mappings":";;;;;;AAAA,IAAIA,QAAQC,QAAQ,OAAR,CAAZ;AACA,IAAIC,WAAWD,QAAQ,UAAR,CAAf;;AAEA,IAAIE,QAAQC,GAAGC,IAAH,CAAQ;AAChBC,UAAM,CAAC,CADS;AAEhBC,SAAM,CAAC,CAFS;AAGhBC,UAAM,CAAC;AAHS,CAAR,CAAZ;;AAMA,IAAIC,cAAcL,GAAGM,KAAH,CAAS;AACvBC,aAASP,GAAGQ,SADW;AAEvB;AACAC,gBAAY;AACR;AACAC,eAAOd,KAFC;AAGR;AACAe,sBAAcX,GAAGY,IAJT;AAKR;AACAC,mBAAWb,GAAGc,KANN;AAOR;AACAC,qBAAa;AACTC,qBAAS,IADA;AAETC,iBAAKjB,GAAGkB;AAFC,SARL;AAYR;AACAC,kBAAU;AACNH,qBAAS,IADH;AAENC,iBAAKjB,GAAGkB;AAFF,SAbF;AAiBR;AACAE,uBAAe;AACXJ,qBAAS,IADE;AAEXC,iBAAKjB,GAAGkB;AAFG,SAlBP;AAsBR;AACAG,oBAAY;AACRL,qBAAS,IADD;AAERC,iBAAKjB,GAAGkB;AAFA;AAvBJ,KAHW;;AAgCvBI,aAAS;AACLvB;AADK,KAhCc;;AAoCvBwB,UApCuB,oBAoCb;AACNC,UAAEnB,WAAF,GAAgBA,WAAhB;AACAmB,UAAEC,IAAF,GAAS,IAAT;;AAEA;AACAzB,WAAG0B,QAAH,CAAYC,mBAAZ,GAAkCC,OAAlC,GAA4C,IAA5C;;AAEA;AACA,aAAKC,KAAL,GAAa9B,MAAMG,IAAnB;AACA;AACA,aAAK4B,KAAL,GAAa,CAAb;AACA,aAAKjB,SAAL,CAAekB,MAAf,GAAwB,KAAKD,KAA7B;AACA,aAAKnB,YAAL,CAAkBqB,MAAlB,GAA2B,KAA3B;AACA,aAAKtB,KAAL,CAAWuB,IAAX;AACH,KAlDsB;;AAmDvB;AACAC,SApDuB,mBAoDd;AACL,aAAKL,KAAL,GAAa9B,MAAMI,GAAnB;AACA,aAAK2B,KAAL,GAAa,CAAb;AACAN,UAAEW,WAAF,CAAcC,UAAd;AACA,aAAK1B,KAAL,CAAW2B,QAAX;AACH,KAzDsB;AA0DvBC,YA1DuB,sBA0DX;AACR;AACAtC,WAAGuC,WAAH,CAAeC,SAAf,CAAyB,KAAKzB,WAA9B;AACAf,WAAGuC,WAAH,CAAeE,UAAf,CAA0B,KAAKtB,QAA/B;AACAnB,WAAGuC,WAAH,CAAeE,UAAf,CAA0B,KAAKrB,aAA/B;AACAI,UAAEW,WAAF,CAAcO,KAAd;AACA,aAAKb,KAAL,GAAa9B,MAAMK,IAAnB;AACA,aAAKO,YAAL,CAAkBqB,MAAlB,GAA2B,IAA3B;AACA,aAAKrB,YAAL,CAAkBgC,YAAlB,CAA+B,cAA/B,EAA+Cb,KAA/C,CAAqDC,MAArD,GAA8D,KAAKD,KAAnE;AACH,KAnEsB;;AAoEvB;AACAc,aArEuB,uBAqEV;AACT;AACA,aAAKd,KAAL;AACA,aAAKjB,SAAL,CAAekB,MAAf,GAAwB,KAAKD,KAA7B;AACA;AACA9B,WAAGuC,WAAH,CAAeE,UAAf,CAA0B,KAAKpB,UAA/B;AACH;AA3EsB,CAAT,CAAlB","file":"GameManager.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["var Sheep = require('Sheep');\nvar Scroller = require('Scroller');\n\nvar State = cc.Enum({\n    Menu: -1,\n    Run : -1,\n    Over: -1\n});\n\nvar GameManager = cc.Class({\n    extends: cc.Component,\n    //-- 属性\n    properties: {\n        //-- 获取绵羊\n        sheep: Sheep,\n        //-- 获取gameOverMenu对象\n        gameOverMenu: cc.Node,\n        //-- 获取分数对象\n        scoreText: cc.Label,\n        //-- 获取背景音效\n        gameBgAudio: {\n            default: null,\n            url: cc.AudioClip\n        },\n        //-- 获取死亡音效\n        dieAudio: {\n            default: null,\n            url: cc.AudioClip\n        },\n        //-- 获取失败音效\n        gameOverAudio: {\n            default: null,\n            url: cc.AudioClip\n        },\n        //-- 获取得分音效\n        scoreAudio: {\n            default: null,\n            url: cc.AudioClip\n        }\n    },\n\n    statics: {\n        State\n    },\n\n    onLoad () {\n        D.GameManager = GameManager;\n        D.game = this;\n\n        // activate colliders\n        cc.director.getCollisionManager().enabled = true;\n\n        //-- 游戏状态\n        this.state = State.Menu;\n        //-- 分数\n        this.score = 0;\n        this.scoreText.string = this.score;\n        this.gameOverMenu.active = false;\n        this.sheep.init();\n    },\n    //-- 开始\n    start () {\n        this.state = State.Run;\n        this.score = 0;\n        D.pipeManager.startSpawn();\n        this.sheep.startRun();\n    },\n    gameOver () {\n        //-- 背景音效停止，死亡音效播放\n        cc.audioEngine.stopMusic(this.gameBgAudio);\n        cc.audioEngine.playEffect(this.dieAudio);\n        cc.audioEngine.playEffect(this.gameOverAudio);\n        D.pipeManager.reset();\n        this.state = State.Over;\n        this.gameOverMenu.active = true;\n        this.gameOverMenu.getComponent('GameOverMenu').score.string = this.score;\n    },\n    //-- 更新分数\n    gainScore () {\n        //-- 分数+1\n        this.score++;\n        this.scoreText.string = this.score;\n        //-- 分数增加音效\n        cc.audioEngine.playEffect(this.scoreAudio);\n    }\n});\n"]}